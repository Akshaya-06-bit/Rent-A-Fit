<!DOCTYPE html>
<html>
<head>
  <title>Your Cart</title>
  <link rel="stylesheet" href="/stylesheets/cart.css">
</head>
<body>
  <div class="headings">
    <h1>Your Cart</h1>
    <h2>Total: ₹<%= total %></h2>
  </div>

  <% if (!cartItems || cartItems.length === 0) { %>
    <p>Your cart is empty.</p>
  <% } else { %>
    <% cartItems.forEach(item => { %>
      <div class="cart-item">
        <img src="<%= '/multer/' + ((item.productId && item.productId.image) ? item.productId.image : 'placeholder.png') %>" alt="<%= item.productId ? item.productId.name : 'Product' %>">
        <h3><%= item.productId ? item.productId.name : 'Product removed' %></h3>
        <p>₹<%= item.productId ? item.productId.price : 0 %> x <%= item.quantity %></p>
        <form action="/cart/delete/<%= item._id %>" method="POST" style="margin-left:auto;">
          <button type="submit" class="remove-btn">Remove</button>
        </form>
        <% if (item.productId && item.productId.status === 'available') { %>
          <form action="/cart/buynow/<%= item._id %>" method="POST" style="margin-left:10px;">
            <button type="submit" class="remove-btn">Buy Now</button>
          </form>
        <% } %>
      </div>
    <% }) %>
  <% } %>
</body>
</html>
