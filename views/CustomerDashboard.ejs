<!DOCTYPE html>
<html>
<head>
  <title>Customer Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <h1>Welcome, <%= user.email %></h1>
  <h3>Total Spent: â‚¹<%= totalSpent %></h3>

  <% if (orders && orders.length > 0) { %>
    <canvas id="monthlySpendingChart" width="600" height="300"></canvas>

    <script>
      const labels = <%- JSON.stringify(chartLabels) %>;
      const data = <%- JSON.stringify(chartData) %>;

      const ctx = document.getElementById('monthlySpendingChart').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: labels,
          datasets: [{
            label: 'Monthly Spending',
            data: data,
            fill: true,
            borderColor: 'rgba(75, 192, 192, 1)',
            backgroundColor: 'rgba(75, 192, 192, 0.2)',
            tension: 0.3
          }]
        },
        options: { responsive: true }
      });
    </script>
  <% } else { %>
    <p>No orders yet.</p>
  <% } %>
</body>
</html>
